<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="opensheetmusicdisplay.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; }
    </style>
</head>
<body>
<div id="score-container"></div>

<script>
    var scoreContainer = document.getElementById("score-container");
    var osmd = new opensheetmusicdisplay.OpenSheetMusicDisplay(scoreContainer, {
        autoResize: true,
        backend: "svg",
        drawingParameters: "compacttight",
        drawTitle: true,
    });

    function loadScore(xmlData) {
        osmd.load(xmlData).then(() => osmd.render(), (err) => console.error(err));
    }
    function nextCursor() { osmd.cursor.next(); }
    function resetCursor() { osmd.cursor.reset(); }

    const viewport = window.visualViewport;

    function reportViewportChanges() {
        if (window.Android) {
            const scrollX = viewport.offsetLeft;
            const scrollY = viewport.offsetTop;
            const scale = viewport.scale;

            if (typeof window.Android.notifyScrollChanged === 'function') {
                window.Android.notifyScrollChanged(Math.round(scrollX), Math.round(scrollY));
            }
            if (typeof window.Android.notifyScaleChanged === 'function') {
                window.Android.notifyScaleChanged(scale);
            }
        }
    }

    viewport.addEventListener('scroll', reportViewportChanges);
    viewport.addEventListener('resize', reportViewportChanges);
</script>
</body>
</html>